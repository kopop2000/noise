name: Build VST2 Plugin

on: [workflow_dispatch]

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Setup MSVC
      uses: ilammy/msvc-dev-cmd@v1
      
    - name: Clone and Build
      run: |
        git clone https://github.com/vaisest/noise-suppression-for-voice.git
        cd noise-suppression-for-voice
        
        mkdir build
        cd build
        
        # Простая конфигурация
        cmake .. -G "Visual Studio 17 2022" -A x64
        
        # Сборка только основных целей
        cmake --build . --config Release --target noise_suppression
        
    - name: Upload Results
      uses: actions/upload-artifact@v4
      with:
        name: noise-suppression-files
        path: |
          noise-suppression-for-voice/build/Release/*.dll
          noise-suppression-for-voice/build/Release/*.exe
